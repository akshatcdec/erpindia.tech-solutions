@model IEnumerable<ERPIndia.Models.CollectFee.DTOs.FeeCollectionDto>
@using ERPIndia.Class.Helper
@{
    Layout = null;
}
<link href="/Content/model.css" rel="stylesheet" />
<!-- Add this to your existing <style> section -->
<style>
    /* Existing styles... */

    /* Alternating row colors */
    

   
</style>
<style>

    /* CSS */
    .cert-btn {
        display: inline-flex;
        align-items: center;
        gap: 8px;
        background: linear-gradient(to bottom, #5ec82f, #3e9f12);
        border: none;
        border-radius: 12px;
        padding: 4px 18px; /* 👈 कम ऊँचाई */
        font-size: 12px; /* 👈 छोटा टेक्स्ट */
        font-weight: 500;
        color: white;
        box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        cursor: pointer;
        transition: transform 0.1s ease, box-shadow 0.1s ease;
    }

        .cert-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.25);
        }

        .cert-btn:active {
            transform: translateY(0);
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .cert-btn .icon {
            display: flex;
            align-items: center;
            justify-content:center;
        }



    #certificateTable th {
        background-color: #e3f2fd;
        position: sticky;
        color: black;
        top: 0;
        z-index: 10;
        font-weight: bold;
        text-align: center;
        border: 1px solid #dee2e6;
    }


    #certificateTable tbody tr:nth-child(even) td {
        background-color: #e9ecef;
    }


    #certificateTable td {
        border: 1px solid #dee2e6;
        vertical-align: middle;
    }

    #certificateTable {
        width: 100%;
    }

    .certificate-actions {
        white-space: nowrap;
        text-align: center;
    }
</style>

@if (Model != null && Model.Any())
{
    <div class="card">
        <div class="card-header bg-light">
            <div class="row align-items-center">
                <div class="col">
                    <h5 class="card-title mb-0">
                        <i class="fas fa-print"></i> Certificate Printing
                    </h5>
                </div>
            </div>
        </div>
        <div class="card-body">
            <div class="table-responsive">
                <table id="certificateTable" class="table table-bordered display" style="width:100%">
                    <thead>
                        <tr>
                            <th width="15%">Certificates</th>
                            <th>Adm No</th>
                            <th>Class</th>
                            <th>Sec</th>
                            <th>Student Name</th>
                            <th>Father Name</th>
                            <th>Gender</th>
                            <th>Category</th>
                            <th>Mobile</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var student in Model)
                        {
                            <tr data-student-id="@student.StudentId">
                                <td class="certificate-actions">
                                    <button onclick="printCertificate('@student.StudentId', 'cc', '@student.AdmsnNo')"
                                            class="cert-btn" title="Print Char. Certificate">
                                        <i class="fas fa-file-alt"></i>
                                        Char. Certificate
                                    </button>
                                </td>
                                <td>@student.AdmsnNo</td>
                                <td>@student.ClassName</td>
                                <td>@student.SectionName</td>
                                <td>@student.FirstName</td>
                                <td>@(student.FatherName ?? "")</td>
                                <td>@(student.Gender ?? "")</td>
                                <td>@(student.CategoryName ?? "")</td>
                                <td>@student.Mobile</td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>
    </div>
}

<script>
    $(function () {
        // Initialize DataTable
        var table = $('#certificateTable').DataTable({
            "lengthMenu": [[10, 25, 50, 100, -1], [10, 25, 50, 100, "All"]],
            "pageLength": 10,
            "order": [[2, "asc"], [3, "asc"]], // Order by Class and Section
            "scrollX": false,
            "responsive": true,
            "dom": 'Blfrtip',
            "buttons": [
                {
                    extend: 'copy',
                    className: 'btn btn-sm btn-secondary'
                },
                {
                    extend: 'csv',
                    title: 'CertificateStudentList',
                    className: 'btn btn-sm btn-secondary'
                },
                {
                    extend: 'excel',
                    title: 'CertificateStudentList',
                    className: 'btn btn-sm btn-secondary'
                },
                {
                    extend: 'pdf',
                    title: 'CertificateStudentList',
                    className: 'btn btn-sm btn-secondary',
                    orientation: 'landscape'
                },
                {
                    extend: 'print',
                    title: 'CertificateStudentList',
                    className: 'btn btn-sm btn-secondary'
                }
            ]
        });
    });

    function toTitleCase(str) {
        return str
            // turn camelCase or PascalCase into words with spaces
            .replace(/([a-z])([A-Z])/g, '$1 $2')
            // turn dashes/underscores into spaces
            .replace(/[-_]+/g, ' ')
            .toLowerCase()
            .replace(/\b\w/g, ch => ch.toUpperCase());
    }

    // Function to print certificates
    function printCertificate(studentId, certificateType, admissionNo) {
        var schoolCode = '@ERPIndia.Class.Helper.CommonLogic.GetSessionValue(ERPIndia.Class.Helper.StringConstants.TenantCode)';
        var url = '';

        switch(certificateType) {
            case 'bonafide':
                url = '@Url.Action("PrintBonafide", "Certificate")' + '?studentId=' + studentId + '&admissionNo=' + admissionNo + '&code=' + schoolCode;
                break;
            case 'dob':
                url = '@Url.Action("PrintDOB", "Certificate")' + '?studentId=' + studentId + '&admissionNo=' + admissionNo + '&code=' + schoolCode;
                break;
            case 'cc':
                url = '@Url.Action("PrintCharacter", "Certificate")' + '?studentId=' + studentId + '&admissionNo=' + admissionNo + '&code=' + schoolCode;
                break;
        }
        openModal('', url, 'Char Certificate');
    }
</script>